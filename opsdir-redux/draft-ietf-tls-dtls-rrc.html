<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Return Routability Check for DTLS 1.2 and DTLS 1.3</title>
<meta content="Hannes Tschofenig" name="author">
<meta content="Achim Kraus" name="author">
<meta content="Thomas Fossati" name="author">
<meta content="
       This document specifies a return routability check for use in context of the
Connection ID (CID) construct for the Datagram Transport Layer Security (DTLS)
protocol versions 1.2 and 1.3. 
    " name="description">
<meta content="xml2rfc 3.28.1" name="generator">
<meta content="DTLS, RRC, CID" name="keyword">
<meta content="draft-ietf-tls-dtls-rrc-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.28.1
    Python 3.12.10
    ConfigArgParse 1.7
    google-i18n-address 3.1.1
    intervaltree 3.1.0
    Jinja2 3.1.6
    lxml 5.3.1
    platformdirs 4.3.8
    pycountry 24.6.1
    PyYAML 6.0.2
    requests 2.32.3
    setuptools 80.9.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-tls-dtls-rrc.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: italic;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C8A, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0301, U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-greek.woff2') format('woff2');
  unicode-range: U+0370-0377, U+037A-037F, U+0384-038A, U+038C, U+038E-03A1, U+03A3-03FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-02BA, U+02BD-02C5, U+02C7-02CC, U+02CE-02D7, U+02DD-02FF, U+0304, U+0308, U+0329, U+1D00-1DBF, U+1E00-1E9F, U+1EF2-1EFF, U+2020, U+20A0-20AB, U+20AD-20C0, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Sofia Sans Semi Condensed';
  font-style: normal;
  font-weight: 1 1000;
  src: url('https://martinthomson.github.io/rfc-css/fonts/sofiasanssemicondensed-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+0304, U+0308, U+0329, U+2000-206F, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  --font-title: "Sofia Sans Semi Condensed", sans-serif;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
section {
  clear: both;
}
.section-number {
  padding-right: 0.5em;
}
h1, h2, h3, h4, h5, h6 {
  font-family: var(--font-title);
  font-weight: 680;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
  vertical-align: top;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
  & :is(ol, ul) {
    margin-left: 1em;
  }
}
li {
  margin: 0 0 0.25em 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
  & li {
    margin-top: 0.5em;
  }
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  margin: 0 0 0 2em;
  & li {
    margin: 0;
    & :first-child { margin-top: 0; }
    & :last-child { margin-bottom: 0; }
  }
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
  &.olPercent {
    --indent: 5ch;
    & > dt {
      min-width: calc(var(--indent) - 2ch);
    }
  }
  &.olPercent > dt {
    float: none;
  }

  dl > dd > & {
    margin-top: 0.5em;
    margin-bottom: 0;
  }
}
dl:not(.dlNewline) > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
  & > :is(:first-child, .break:first-child + *) {
    margin-top: 0;
  }
  & > :is(:last-child) {
    margin-bottom: 0;
  }
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
  caption-side: bottom;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    /* In the horizontal direction, sometimes people make over-sized figures.
       Scrollbars for those is therefore necessary: auto adds them as necessary..
       In the vertical direction, the line-height can combine with the font
       asender/descender height to produce scrollbars: hidden avoids that. */
    overflow: auto hidden;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: auto;
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
  &[href] {
    color: var(--pilcrow-weak);
    &:hover { text-decoration: none; }
  }
}
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
  & dt {
    width: var(--identifier-width);
    min-width: var(--identifier-width);
    clear: left;
    float: left;
    text-align: right;
    margin-right: 1ch;
  }
  & dd {
    margin: 0;
    margin-left: calc(1em + var(--identifier-width)) !important;
    min-width: 5em;
  }
  & .authors {
    & .author {
      display: inline-block;
      margin-right: 1.5em;
    }
    & .org {
      font-style: italic;
    }
  }
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;

  & nav {
    & ul {
      margin: 0 0.5em 0 0;
      padding: 0;
      list-style: none;
    }
    & li {
      line-height: 1.3em;
      margin: 2px 0;
      padding-left: 1.2em;
      text-indent: -1.2em;
    }
  }
  & a.xref {
    white-space: normal;
  }
}

.references {
  & > dt {
    text-align: right;
    font-weight: bold;
    min-width: 10ch;
    margin-right: 1.5ch;
    &:target::before {
      content: "⇒";
      margin: 0 10px 0 -25px;
    }
  }
  & > dd {
    margin-left: 12ch !important;
    overflow: visible;
    & .refInstance {
      margin-bottom: 0.8em;
    }
    & .ascii {
      margin-bottom: 0.25em;
    }
  }
}

#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  max-width: 20em;
  margin: 1em auto 1em 0;

  & .nameRole {
    font-weight: 700;
    margin-left: 0;
  }
  & .label {
    margin: 0.5em 0;
  }
  & .type {
    display: none;
  }
  & .alternative-contact {
    margin: 0.5em 0 0.25em 0;
  }
  & .non-ascii {
    margin: 0 0 0 2em;
  }
  & div.left {
    text-align: left;
  }
  & div.right {
    text-align: right;
  }
}

hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

/* Comments */
.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}

@media screen {
  #toc nav {
    font-family: var(--font-title);
    font-weight: 360;
    & > ul { margin-bottom: 2em; }
    & ul {
      margin: 0 0 0 4px;
      & :is(p, li) {
        margin: 2px 0;
      }
    }
  }
  #toc a.toplink {
    float: right;
  }
}
@media not screen {
  #toc a.toplink {
    display: none;
  }
}


/* TOC layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
    &::before { /* css hamburger */
      float: right;
      position: relative;
      width: 1em;
      height: 1px;
      left: -164px;
      margin: 8px 0 0 0;
      background: white none repeat scroll 0 0;
      box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
      content: "";
    }
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active {
    opacity: 1;
    & nav { display: block; }
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:is(:link, :focus, :hover),
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin: 2px 0.5em 0;
  }
}

/* TOC layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
  #toc a.toplink {
    margin: 8px 0.5em 0;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">DTLS Return Routability Check</td>
<td class="right">June 2025</td>
</tr></thead>
<tfoot><tr>
<td class="left">Tschofenig, et al.</td>
<td class="center">Expires 8 December 2025</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TLS</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-tls-dtls-rrc-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2025-06-06" class="published">6 June 2025</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2025-12-08">8 December 2025</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. Tschofenig, <span class="editor">Ed.</span>
</div>
<div class="org">H-BRS</div>
</div>
<div class="author">
      <div class="author-name">A. Kraus</div>
</div>
<div class="author">
      <div class="author-name">T. Fossati</div>
<div class="org">Linaro</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Return Routability Check for DTLS 1.2 and DTLS 1.3</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a return routability check for use in context of the
Connection ID (CID) construct for the Datagram Transport Layer Security (DTLS)
protocol versions 1.2 and 1.3.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
  Transport Layer Security Working Group mailing list (tls@ietf.org),
  which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/tls/">https://mailarchive.ietf.org/arch/browse/tls/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/tlswg/dtls-rrc">https://github.com/tlswg/dtls-rrc</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 8 December 2025.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2025 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-conventions-and-terminology" class="internal xref">Conventions and Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-rrc-extension" class="internal xref">RRC Extension</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-rrc-and-cid-interplay" class="internal xref">RRC and CID Interplay</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-return-routability-check-me" class="internal xref">Return Routability Check Message Types</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-attacker-model" class="internal xref">Attacker Model</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="auto internal xref">5.1</a>.  <a href="#name-amplification" class="internal xref">Amplification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="auto internal xref">5.1.1</a>.  <a href="#name-mitigation-strategy" class="internal xref">Mitigation Strategy</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="auto internal xref">5.2</a>.  <a href="#name-off-path-packet-forwarding" class="internal xref">Off-Path Packet Forwarding</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="auto internal xref">5.2.1</a>.  <a href="#name-mitigation-strategy-2" class="internal xref">Mitigation Strategy</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-path-validation-procedure" class="internal xref">Path Validation Procedure</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="auto internal xref">6.1</a>.  <a href="#name-basic" class="internal xref">Basic</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="auto internal xref">6.2</a>.  <a href="#name-enhanced" class="internal xref">Enhanced</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="auto internal xref">6.3</a>.  <a href="#name-path-challenge-requirements" class="internal xref">Path Challenge Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="auto internal xref">6.4</a>.  <a href="#name-path-response-drop-requirem" class="internal xref">Path Response/Drop Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="auto internal xref">6.5</a>.  <a href="#name-timer-choice" class="internal xref">Timer Choice</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-example" class="internal xref">Example</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-privacy-considerations" class="internal xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="auto internal xref">10</a>. <a href="#name-operational-considerations" class="internal xref">Operational Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="auto internal xref">10.1</a>.  <a href="#name-logging-anomalous-events" class="internal xref">Logging Anomalous Events</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="auto internal xref">10.2</a>.  <a href="#name-middlebox-interference" class="internal xref">Middlebox Interference</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="auto internal xref">11</a>. <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="auto internal xref">11.1</a>.  <a href="#name-new-tls-contenttype" class="internal xref">New TLS ContentType</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="auto internal xref">11.2</a>.  <a href="#name-new-tls-extensiontype" class="internal xref">New TLS ExtensionType</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="auto internal xref">11.3</a>.  <a href="#name-new-rrc-message-type-sub-re" class="internal xref">New RRC Message Type Sub-registry</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3.2.1">
                    <p id="section-toc.1-1.11.2.3.2.1.1"><a href="#section-11.3.1" class="auto internal xref">11.3.1</a>.  <a href="#name-designated-expert-instructi" class="internal xref">Designated Expert Instructions</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="auto internal xref">12</a>. <a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="auto internal xref">13</a>. <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="auto internal xref">13.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="auto internal xref">13.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-A" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">A Connection ID (CID) is an identifier carried in the record layer header of a DTLS datagram
that gives the receiver additional information for selecting the appropriate
security context.  The CID mechanism has been specified in <span>[<a href="#RFC9146" class="cite xref">RFC9146</a>]</span> for
DTLS 1.2 and in <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span> for DTLS 1.3.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Section 6 of <span>[<a href="#RFC9146" class="cite xref">RFC9146</a>]</span> describes how the use of CID increases the attack
surface of DTLS 1.2 and 1.3 by providing both on-path and off-path attackers an opportunity for
(D)DoS.  It also describes the steps a DTLS principal must take when a
record with a CID is received that has a source address (and/or port) different
from the one currently associated with the DTLS connection.  However, the
actual mechanism for ensuring that the new peer address is willing to receive
and process DTLS records is left open.  To address the gap, this document defines a return
routability check (RRC) sub-protocol for DTLS 1.2 and 1.3.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The return routability check is performed by the receiving endpoint before the
CID-address binding is updated in that endpoint's session state.
This is done in order to give the receiving endpoint confidence
that the sending peer is in fact reachable at the source address (and port) indicated in the received datagram.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4"><a href="#regular" class="auto internal xref">Section 6.1</a> of this document explains the fundamental mechanism that aims to reduce the DDoS attack surface.
Additionally, in <a href="#enhanced" class="auto internal xref">Section 6.2</a>, a more advanced address validation mechanism is discussed.
This mechanism is designed to counteract off-path attackers trying to place themselves on-path by racing packets that trigger address rebinding at the receiver.
To gain a detailed understanding of the attacker model, please refer to <a href="#attacker" class="auto internal xref">Section 5</a>.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Apart from of its use in the context of CID-address binding updates,
the path validation capability offered by RRC can be used at any time by either endpoint. For
instance, an endpoint might use RRC to check that a peer is still reachable at
its last known address after a period of quiescence.<a href="#section-1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conventions-and-terminology">
<section id="section-2">
      <h2 id="name-conventions-and-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
      </h2>
<p id="section-2-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>",
"<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">This document assumes familiarity with the CID format and protocol defined for
DTLS 1.2 <span>[<a href="#RFC9146" class="cite xref">RFC9146</a>]</span> and for DTLS 1.3 <span>[<a href="#RFC9147" class="cite xref">RFC9147</a>]</span>.  The presentation language
used in this document is described in Section 4 of <span>[<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">This document reuses the definition of "anti-amplification limit" from
<span>[<a href="#RFC9000" class="cite xref">RFC9000</a>]</span> to mean three times the amount of data received from an
unvalidated address.  This includes all DTLS records originating from that
source address, excluding discarded ones.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">The terms "peer" and "endpoint" are defined in <span><a href="https://rfc-editor.org/rfc/rfc8446#section-1.1" class="relref">Section 1.1</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>.<a href="#section-2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rrc-extension">
<section id="section-3">
      <h2 id="name-rrc-extension">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-rrc-extension" class="section-name selfRef">RRC Extension</a>
      </h2>
<p id="section-3-1">The use of RRC is negotiated via the <code>rrc</code> extension.
The <code>rrc</code> extension is only defined for DTLS 1.2 and DTLS 1.3.
On connecting, a client wishing to use RRC includes the <code>rrc</code> extension in its ClientHello.
If the server is capable of meeting this requirement, it responds with a
<code>rrc</code> extension in its ServerHello.  The <code>extension_type</code> value for this
extension is TBD1 and the <code>extension_data</code> field of this extension is empty.
The client and server <span class="bcp14">MUST NOT</span> use RRC unless both sides have successfully
exchanged <code>rrc</code> extensions.
A client offering the <code>rrc</code> extension <span class="bcp14">MUST</span> also offer the <code>connection_id</code> extension <span>[<a href="#RFC9146" class="cite xref">RFC9146</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="rrc-and-cid-interplay">
<section id="section-3.1">
        <h3 id="name-rrc-and-cid-interplay">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-rrc-and-cid-interplay" class="section-name selfRef">RRC and CID Interplay</a>
        </h3>
<p id="section-3.1-1">RRC offers an in-protocol mechanism to perform peer address validation that
complements the "peer address update" procedure described in <span><a href="https://rfc-editor.org/rfc/rfc9146#section-6" class="relref">Section 6</a> of [<a href="#RFC9146" class="cite xref">RFC9146</a>]</span>.  Specifically, when both CID <span>[<a href="#RFC9146" class="cite xref">RFC9146</a>]</span> and RRC have been
successfully negotiated for the session, if a record with CID is received that
has the source address and/or source port number of the enclosing UDP datagram different from what is
currently associated with that CID value, the receiver <span class="bcp14">SHOULD</span> perform a return
routability check as described in <a href="#path-validation" class="auto internal xref">Section 6</a>, unless an application
layer specific address validation mechanism can be triggered instead (e.g., CoAP Echo <span>[<a href="#RFC9175" class="cite xref">RFC9175</a>]</span>).<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="return-routability-check-message-types">
<section id="section-4">
      <h2 id="name-return-routability-check-me">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-return-routability-check-me" class="section-name selfRef">Return Routability Check Message Types</a>
      </h2>
<p id="section-4-1">This document defines the <code>return_routability_check</code> content type
(<a href="#fig-rrc-msg" class="auto internal xref">Figure 1</a>) to carry Return Routability Check messages.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The RRC sub-protocol consists of three message types: <code>path_challenge</code>, <code>path_response</code>
and <code>path_drop</code> that are used for path validation and selection as described in
<a href="#path-validation" class="auto internal xref">Section 6</a>.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">Each message carries a Cookie, an 8-byte field containing 64 bits of entropy (e.g., obtained from the CSPRNG used by the TLS implementation, see <span><a href="https://rfc-editor.org/rfc/rfc8446#appendix-C.1" class="relref">Appendix C.1</a> of [<a href="#RFC8446" class="cite xref">RFC8446</a>]</span>).<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">The <code>return_routability_check</code> message <span class="bcp14">MUST</span> be authenticated and encrypted
using the currently active security context.<a href="#section-4-4" class="pilcrow">¶</a></p>
<span id="name-return-routability-check-mes"></span><div id="fig-rrc-msg">
<figure id="figure-1">
        <div class="lang-tls-msg sourcecode" id="section-4-5.1">
<pre>
enum {
    invalid(0),
    change_cipher_spec(20),
    alert(21),
    handshake(22),
    application_data(23),
    heartbeat(24),  /* RFC 6520 */
    tls12_cid(25),  /* RFC 9146, DTLS 1.2 only */
    return_routability_check(TBD2), /* NEW */
    (255)
} ContentType;

uint64 Cookie;

enum {
    path_challenge(0),
    path_response(1),
    path_drop(2),
    (255)
} rrc_msg_type;

struct {
    rrc_msg_type msg_type;
    select (return_routability_check.msg_type) {
        case path_challenge: Cookie;
        case path_response:  Cookie;
        case path_drop:      Cookie;
    };
} return_routability_check;
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-return-routability-check-mes" class="selfRef">Return Routability Check Message</a>
        </figcaption></figure>
</div>
<p id="section-4-6">Future extensions to the Return Routability Check sub-protocol may
define new message types.
Implementations <span class="bcp14">MUST</span> be able to parse and understand the three RRC message types defined in this document.
In addition, implementations <span class="bcp14">MUST</span> be able to parse and gracefully ignore messages with an unknown <code>msg_type</code>.<a href="#section-4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="attacker">
<section id="section-5">
      <h2 id="name-attacker-model">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-attacker-model" class="section-name selfRef">Attacker Model</a>
      </h2>
<p id="section-5-1">We define two classes of attackers, off-path and on-path, with increasing
capabilities (see <a href="#fig-attacker-capabilities" class="auto internal xref">Figure 2</a>) partly following terminology
introduced in QUIC <span>[<a href="#RFC9000" class="cite xref">RFC9000</a>]</span>:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">
          <p id="section-5-2.1.1">An off-path attacker is not on the original path between the DTLS peers, but
is able to observe packets on the original path and has faster routing
compared to the DTLS peers, which allows it to make copies of the observed
packets, race its copies to either peer and consistently win the race.<a href="#section-5-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-2.2">
          <p id="section-5-2.2.1">An on-path attacker is on the original path between the DTLS peers and is
therefore capable, compared to the off-path attacker, to also drop and delay
records at will.<a href="#section-5-2.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-5-3">Note that, in general, attackers cannot craft DTLS records in a way that would
successfully pass verification, due to the cryptographic protections applied by
the DTLS record layer.<a href="#section-5-3" class="pilcrow">¶</a></p>
<span id="name-attacker-capabilities"></span><div id="fig-attacker-capabilities">
<figure id="figure-2">
        <div id="section-5-4.1">
          <div class="alignCenter art-svg artwork" id="section-5-4.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="272" width="448" viewBox="0 0 448 272" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 40,32 L 40,80" fill="none" stroke="black"></path>
              <path d="M 40,112 L 40,160" fill="none" stroke="black"></path>
              <path d="M 80,32 L 80,256" fill="none" stroke="black"></path>
              <path d="M 376,32 L 376,256" fill="none" stroke="black"></path>
              <path d="M 416,32 L 416,128" fill="none" stroke="black"></path>
              <path d="M 416,160 L 416,256" fill="none" stroke="black"></path>
              <path d="M 40,32 L 64,32" fill="none" stroke="black"></path>
              <path d="M 80,32 L 376,32" fill="none" stroke="black"></path>
              <path d="M 392,32 L 416,32" fill="none" stroke="black"></path>
              <path d="M 80,64 L 376,64" fill="none" stroke="black"></path>
              <path d="M 80,96 L 376,96" fill="none" stroke="black"></path>
              <path d="M 80,128 L 376,128" fill="none" stroke="black"></path>
              <path d="M 40,160 L 64,160" fill="none" stroke="black"></path>
              <path d="M 80,160 L 376,160" fill="none" stroke="black"></path>
              <path d="M 80,192 L 376,192" fill="none" stroke="black"></path>
              <path d="M 80,224 L 376,224" fill="none" stroke="black"></path>
              <path d="M 80,256 L 376,256" fill="none" stroke="black"></path>
              <path d="M 392,256 L 416,256" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="400,256 388,250.4 388,261.6" fill="black" transform="rotate(180,392,256)"></polygon>
              <polygon class="arrowhead" points="400,32 388,26.4 388,37.6" fill="black" transform="rotate(180,392,32)"></polygon>
              <polygon class="arrowhead" points="72,160 60,154.4 60,165.6" fill="black" transform="rotate(0,64,160)"></polygon>
              <polygon class="arrowhead" points="72,32 60,26.4 60,37.6" fill="black" transform="rotate(0,64,32)"></polygon>
              <g class="text">
                <text x="120" y="52">Inspect</text>
                <text x="204" y="52">un-encrypted</text>
                <text x="292" y="52">portions</text>
                <text x="116" y="84">Inject</text>
                <text x="36" y="100">off-path</text>
                <text x="120" y="116">Reorder</text>
                <text x="116" y="148">Modify</text>
                <text x="212" y="148">un-authenticated</text>
                <text x="316" y="148">portions</text>
                <text x="416" y="148">on-path</text>
                <text x="112" y="180">Delay</text>
                <text x="108" y="212">Drop</text>
                <text x="132" y="244">Manipulate</text>
                <text x="192" y="244">the</text>
                <text x="264" y="244">packetization</text>
                <text x="344" y="244">layer</text>
              </g>
            </svg><a href="#section-5-4.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-attacker-capabilities" class="selfRef">Attacker capabilities</a>
        </figcaption></figure>
</div>
<p id="section-5-5">RRC is designed to defend against the following attacks:<a href="#section-5-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-6.1">
          <p id="section-5-6.1.1">On-path and off-path attackers that try to create an amplification attack by
spoofing the source address of the victim (<a href="#sec-amplification" class="auto internal xref">Section 5.1</a>).<a href="#section-5-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-5-6.2">
          <p id="section-5-6.2.1">Off-path attackers that try to put themselves on-path (<a href="#off-path" class="auto internal xref">Section 5.2</a>),
provided that the enhanced path validation algorithm is used (<a href="#enhanced" class="auto internal xref">Section 6.2</a>).<a href="#section-5-6.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<div id="sec-amplification">
<section id="section-5.1">
        <h3 id="name-amplification">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-amplification" class="section-name selfRef">Amplification</a>
        </h3>
<p id="section-5.1-1">Both on-path and off-path attackers can send a packet (either by modifying it
on the fly, or by copying, injecting, and racing it, respectively) with the
source address modified to that of a victim host.  If the traffic generated by
the server in response is larger compared to the received packet (e.g., a CoAP
server returning an MTU's worth of data from a 20-bytes GET request <span>[<a href="#I-D.irtf-t2trg-amplification-attacks" class="cite xref">I-D.irtf-t2trg-amplification-attacks</a>]</span>) the
attacker can use the server as a traffic amplifier toward the victim.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div id="mitigation-strategy">
<section id="section-5.1.1">
          <h4 id="name-mitigation-strategy">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-mitigation-strategy" class="section-name selfRef">Mitigation Strategy</a>
          </h4>
<p id="section-5.1.1-1">When receiving a packet with a known CID and a spoofed source address, an
RRC-capable endpoint will not send a (potentially large) response but instead a
small <code>path_challenge</code> message to the victim host.  Since the host is not able
to decrypt it and generate a valid <code>path_response</code>, the address validation
fails, which in turn keeps the original address binding unaltered.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">Note that in case of an off-path attacker, the original packet still reaches
the intended destination; therefore, an implementation could use a different
strategy to mitigate the attack.<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="off-path">
<section id="section-5.2">
        <h3 id="name-off-path-packet-forwarding">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-off-path-packet-forwarding" class="section-name selfRef">Off-Path Packet Forwarding</a>
        </h3>
<p id="section-5.2-1">An off-path attacker that can observe packets might forward copies of
genuine packets to endpoints over a different path. If the copied packet arrives before
the genuine packet, this will appear as a path change, like in a genuine NAT rebinding occurrence. Any genuine
packet will be discarded as a duplicate. If the attacker is able to
continue forwarding packets, it might be able to cause migration to a
path via the attacker. This places the attacker on-path, giving it
the ability to observe or drop all subsequent packets.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">This style of attack relies on the attacker using a path that has
the same or better characteristics (e.g., due to a more favourable service level agreements) as the direct path between
endpoints. The attack is more effective if relatively few packets are
sent or if packet loss coincides with the attempted attack.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">A data packet received on the original path that increases the
maximum received packet number will cause the endpoint to move back
to that path. Therefore, eliciting packets on this path increases the
likelihood that the attack is unsuccessful. Note however that, unlike QUIC,
DTLS has no "non-probing" packets so this would require application specific
mechanisms.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<div id="mitigation-strategy-1">
<section id="section-5.2.1">
          <h4 id="name-mitigation-strategy-2">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-mitigation-strategy-2" class="section-name selfRef">Mitigation Strategy</a>
          </h4>
<p id="section-5.2.1-1"><a href="#fig-off-path" class="auto internal xref">Figure 3</a> illustrates the case where a receiver receives a
packet with a new source IP address and/or new port number. In order
to determine whether this path change was not triggered
by an off-path attacker, the receiver will send a RRC message of type
<code>path_challenge</code> (1) on the old path.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<span id="name-off-path-packet-forwarding-"></span><div id="fig-off-path">
<figure id="figure-3">
            <div id="section-5.2.1-2.1">
              <div class="alignCenter art-svg artwork" id="section-5.2.1-2.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="368" width="256" viewBox="0 0 256 368" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 64,80 L 64,176" fill="none" stroke="black"></path>
                  <path d="M 64,208 L 64,304" fill="none" stroke="black"></path>
                  <path d="M 112,48 L 112,112" fill="none" stroke="black"></path>
                  <path d="M 112,272 L 112,336" fill="none" stroke="black"></path>
                  <path d="M 200,48 L 200,112" fill="none" stroke="black"></path>
                  <path d="M 200,272 L 200,336" fill="none" stroke="black"></path>
                  <path d="M 248,80 L 248,304" fill="none" stroke="black"></path>
                  <path d="M 112,48 L 200,48" fill="none" stroke="black"></path>
                  <path d="M 64,80 L 112,80" fill="none" stroke="black"></path>
                  <path d="M 200,80 L 248,80" fill="none" stroke="black"></path>
                  <path d="M 112,112 L 200,112" fill="none" stroke="black"></path>
                  <path d="M 24,176 L 120,176" fill="none" stroke="black"></path>
                  <path d="M 8,208 L 104,208" fill="none" stroke="black"></path>
                  <path d="M 112,272 L 200,272" fill="none" stroke="black"></path>
                  <path d="M 64,304 L 112,304" fill="none" stroke="black"></path>
                  <path d="M 200,304 L 248,304" fill="none" stroke="black"></path>
                  <path d="M 112,336 L 200,336" fill="none" stroke="black"></path>
                  <path d="M 8,208 L 24,176" fill="none" stroke="black"></path>
                  <path d="M 104,208 L 120,176" fill="none" stroke="black"></path>
                  <g class="text">
                    <text x="72" y="36">new</text>
                    <text x="240" y="36">old</text>
                    <text x="76" y="52">path</text>
                    <text x="236" y="52">path</text>
                    <text x="156" y="84">Receiver</text>
                    <text x="64" y="196">Attacker?</text>
                    <text x="156" y="308">Sender</text>
                  </g>
                </svg><a href="#section-5.2.1-2.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-off-path-packet-forwarding-" class="selfRef">Off-Path Packet Forwarding Scenario</a>
            </figcaption></figure>
</div>
<p id="section-5.2.1-3">Three cases need to be considered:<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1-4">Case 1: The old path is dead (e.g., due to a NAT rebinding), which leads to a
timeout of (1).<a href="#section-5.2.1-4" class="pilcrow">¶</a></p>
<p id="section-5.2.1-5">As shown in <a href="#fig-old-path-dead" class="auto internal xref">Figure 4</a>, a <code>path_challenge</code> (2) needs to be sent on
the new path.  If the sender replies with a <code>path_response</code> on the new path
(3), the switch to the new path is considered legitimate.<a href="#section-5.2.1-5" class="pilcrow">¶</a></p>
<span id="name-old-path-is-dead"></span><div id="fig-old-path-dead">
<figure id="figure-4">
            <div id="section-5.2.1-6.1">
              <div class="alignCenter art-svg artwork" id="section-5.2.1-6.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="368" width="384" viewBox="0 0 384 368" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 80,64 L 80,112" fill="none" stroke="black"></path>
                  <path d="M 80,144 L 80,320" fill="none" stroke="black"></path>
                  <path d="M 96,80 L 96,176" fill="none" stroke="black"></path>
                  <path d="M 96,208 L 96,304" fill="none" stroke="black"></path>
                  <path d="M 112,96 L 112,224" fill="none" stroke="black"></path>
                  <path d="M 112,256 L 112,288" fill="none" stroke="black"></path>
                  <path d="M 144,48 L 144,112" fill="none" stroke="black"></path>
                  <path d="M 144,272 L 144,336" fill="none" stroke="black"></path>
                  <path d="M 232,48 L 232,112" fill="none" stroke="black"></path>
                  <path d="M 232,272 L 232,336" fill="none" stroke="black"></path>
                  <path d="M 296,64 L 296,112" fill="none" stroke="black"></path>
                  <path d="M 296,144 L 296,176" fill="none" stroke="black"></path>
                  <path d="M 144,48 L 232,48" fill="none" stroke="black"></path>
                  <path d="M 80,64 L 136,64" fill="none" stroke="black"></path>
                  <path d="M 232,64 L 296,64" fill="none" stroke="black"></path>
                  <path d="M 96,80 L 144,80" fill="none" stroke="black"></path>
                  <path d="M 112,96 L 144,96" fill="none" stroke="black"></path>
                  <path d="M 144,112 L 232,112" fill="none" stroke="black"></path>
                  <path d="M 56,176 L 72,176" fill="none" stroke="black"></path>
                  <path d="M 88,176 L 104,176" fill="none" stroke="black"></path>
                  <path d="M 120,176 L 288,176" fill="none" stroke="black"></path>
                  <path d="M 304,176 L 320,176" fill="none" stroke="black"></path>
                  <path d="M 40,208 L 72,208" fill="none" stroke="black"></path>
                  <path d="M 88,208 L 104,208" fill="none" stroke="black"></path>
                  <path d="M 120,208 L 304,208" fill="none" stroke="black"></path>
                  <path d="M 144,272 L 232,272" fill="none" stroke="black"></path>
                  <path d="M 112,288 L 136,288" fill="none" stroke="black"></path>
                  <path d="M 96,304 L 144,304" fill="none" stroke="black"></path>
                  <path d="M 80,320 L 144,320" fill="none" stroke="black"></path>
                  <path d="M 144,336 L 232,336" fill="none" stroke="black"></path>
                  <path d="M 40,208 L 56,176" fill="none" stroke="black"></path>
                  <path d="M 304,208 L 320,176" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="304,176 292,170.4 292,181.6" fill="black" transform="rotate(90,296,176)"></polygon>
                  <polygon class="arrowhead" points="144,288 132,282.4 132,293.6" fill="black" transform="rotate(0,136,288)"></polygon>
                  <polygon class="arrowhead" points="144,64 132,58.4 132,69.6" fill="black" transform="rotate(0,136,64)"></polygon>
                  <g class="text">
                    <text x="88" y="36">new</text>
                    <text x="288" y="36">old</text>
                    <text x="92" y="52">path</text>
                    <text x="284" y="52">path</text>
                    <text x="188" y="84">Receiver</text>
                    <text x="260" y="84">......</text>
                    <text x="280" y="100">.</text>
                    <text x="280" y="116">.</text>
                    <text x="24" y="132">path-</text>
                    <text x="80" y="132">3</text>
                    <text x="280" y="132">.</text>
                    <text x="296" y="132">1</text>
                    <text x="328" y="132">path-</text>
                    <text x="36" y="148">response</text>
                    <text x="280" y="148">.</text>
                    <text x="344" y="148">challenge</text>
                    <text x="280" y="164">.</text>
                    <text x="184" y="196">NAT</text>
                    <text x="296" y="196">X</text>
                    <text x="352" y="196">timeout</text>
                    <text x="280" y="228">.</text>
                    <text x="112" y="244">2</text>
                    <text x="144" y="244">path-</text>
                    <text x="280" y="244">.</text>
                    <text x="160" y="260">challenge</text>
                    <text x="280" y="260">.</text>
                    <text x="280" y="276">.</text>
                    <text x="280" y="292">.</text>
                    <text x="188" y="308">Sender</text>
                    <text x="260" y="308">.....'</text>
                  </g>
                </svg><a href="#section-5.2.1-6.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-old-path-is-dead" class="selfRef">Old path is dead</a>
            </figcaption></figure>
</div>
<p id="section-5.2.1-7">Case 2: The old path is alive but not preferred.<a href="#section-5.2.1-7" class="pilcrow">¶</a></p>
<p id="section-5.2.1-8">This case is shown in <a href="#fig-old-path-not-preferred" class="auto internal xref">Figure 5</a> whereby the sender
replies with a <code>path_drop</code> message (2) on the old path.  This triggers
the receiver to send a <code>path_challenge</code> (3) on the new path. The sender
will reply with a <code>path_response</code> (4) on the new path, thus providing
confirmation for the path migration.<a href="#section-5.2.1-8" class="pilcrow">¶</a></p>
<span id="name-old-path-is-not-preferred"></span><div id="fig-old-path-not-preferred">
<figure id="figure-5">
            <div id="section-5.2.1-9.1">
              <div class="alignCenter art-svg artwork" id="section-5.2.1-9.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="352" width="424" viewBox="0 0 424 352" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 104,64 L 104,112" fill="none" stroke="black"></path>
                  <path d="M 104,144 L 104,320" fill="none" stroke="black"></path>
                  <path d="M 120,80 L 120,176" fill="none" stroke="black"></path>
                  <path d="M 120,216 L 120,304" fill="none" stroke="black"></path>
                  <path d="M 136,96 L 136,224" fill="none" stroke="black"></path>
                  <path d="M 136,256 L 136,288" fill="none" stroke="black"></path>
                  <path d="M 168,48 L 168,112" fill="none" stroke="black"></path>
                  <path d="M 168,272 L 168,336" fill="none" stroke="black"></path>
                  <path d="M 256,48 L 256,112" fill="none" stroke="black"></path>
                  <path d="M 256,272 L 256,336" fill="none" stroke="black"></path>
                  <path d="M 288,96 L 288,112" fill="none" stroke="black"></path>
                  <path d="M 288,144 L 288,288" fill="none" stroke="black"></path>
                  <path d="M 304,80 L 304,176" fill="none" stroke="black"></path>
                  <path d="M 304,208 L 304,304" fill="none" stroke="black"></path>
                  <path d="M 320,64 L 320,224" fill="none" stroke="black"></path>
                  <path d="M 320,256 L 320,320" fill="none" stroke="black"></path>
                  <path d="M 168,48 L 256,48" fill="none" stroke="black"></path>
                  <path d="M 104,64 L 160,64" fill="none" stroke="black"></path>
                  <path d="M 264,64 L 320,64" fill="none" stroke="black"></path>
                  <path d="M 120,80 L 168,80" fill="none" stroke="black"></path>
                  <path d="M 256,80 L 304,80" fill="none" stroke="black"></path>
                  <path d="M 136,96 L 168,96" fill="none" stroke="black"></path>
                  <path d="M 256,96 L 288,96" fill="none" stroke="black"></path>
                  <path d="M 168,112 L 256,112" fill="none" stroke="black"></path>
                  <path d="M 24,176 L 96,176" fill="none" stroke="black"></path>
                  <path d="M 112,176 L 128,176" fill="none" stroke="black"></path>
                  <path d="M 144,176 L 176,176" fill="none" stroke="black"></path>
                  <path d="M 264,176 L 280,176" fill="none" stroke="black"></path>
                  <path d="M 296,176 L 312,176" fill="none" stroke="black"></path>
                  <path d="M 328,176 L 416,176" fill="none" stroke="black"></path>
                  <path d="M 8,208 L 96,208" fill="none" stroke="black"></path>
                  <path d="M 112,208 L 128,208" fill="none" stroke="black"></path>
                  <path d="M 144,208 L 160,208" fill="none" stroke="black"></path>
                  <path d="M 248,208 L 280,208" fill="none" stroke="black"></path>
                  <path d="M 296,208 L 312,208" fill="none" stroke="black"></path>
                  <path d="M 328,208 L 400,208" fill="none" stroke="black"></path>
                  <path d="M 168,272 L 256,272" fill="none" stroke="black"></path>
                  <path d="M 136,288 L 160,288" fill="none" stroke="black"></path>
                  <path d="M 264,288 L 288,288" fill="none" stroke="black"></path>
                  <path d="M 120,304 L 168,304" fill="none" stroke="black"></path>
                  <path d="M 256,304 L 304,304" fill="none" stroke="black"></path>
                  <path d="M 104,320 L 168,320" fill="none" stroke="black"></path>
                  <path d="M 256,320 L 320,320" fill="none" stroke="black"></path>
                  <path d="M 168,336 L 256,336" fill="none" stroke="black"></path>
                  <path d="M 8,208 L 24,176" fill="none" stroke="black"></path>
                  <path d="M 160,208 L 176,176" fill="none" stroke="black"></path>
                  <path d="M 248,208 L 264,176" fill="none" stroke="black"></path>
                  <path d="M 400,208 L 416,176" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="272,288 260,282.4 260,293.6" fill="black" transform="rotate(180,264,288)"></polygon>
                  <polygon class="arrowhead" points="272,64 260,58.4 260,69.6" fill="black" transform="rotate(180,264,64)"></polygon>
                  <polygon class="arrowhead" points="168,288 156,282.4 156,293.6" fill="black" transform="rotate(0,160,288)"></polygon>
                  <polygon class="arrowhead" points="168,64 156,58.4 156,69.6" fill="black" transform="rotate(0,160,64)"></polygon>
                  <g class="text">
                    <text x="112" y="36">new</text>
                    <text x="312" y="36">old</text>
                    <text x="116" y="52">path</text>
                    <text x="308" y="52">path</text>
                    <text x="212" y="84">Receiver</text>
                    <text x="48" y="132">path-</text>
                    <text x="104" y="132">4</text>
                    <text x="224" y="132">path-</text>
                    <text x="288" y="132">1</text>
                    <text x="60" y="148">response</text>
                    <text x="240" y="148">challenge</text>
                    <text x="52" y="196">AP/NAT</text>
                    <text x="88" y="196">A</text>
                    <text x="356" y="196">AP/NAT</text>
                    <text x="392" y="196">B</text>
                    <text x="136" y="244">3</text>
                    <text x="168" y="244">path-</text>
                    <text x="320" y="244">2</text>
                    <text x="352" y="244">path-</text>
                    <text x="184" y="260">challenge</text>
                    <text x="348" y="260">drop</text>
                    <text x="212" y="308">Sender</text>
                  </g>
                </svg><a href="#section-5.2.1-9.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-old-path-is-not-preferred" class="selfRef">Old path is not preferred</a>
            </figcaption></figure>
</div>
<p id="section-5.2.1-10">Case 3: The old path is alive and preferred.<a href="#section-5.2.1-10" class="pilcrow">¶</a></p>
<p id="section-5.2.1-11">This is most likely the result of an off-path attacker trying to place itself
on path.  The receiver sends a <code>path_challenge</code> on the old path and the sender
replies with a <code>path_response</code> (2) on the old path. The interaction is shown in
<a href="#fig-old-path-preferred" class="auto internal xref">Figure 6</a>. This results in the connection not being migrated
to the new path, thus thwarting the attack.<a href="#section-5.2.1-11" class="pilcrow">¶</a></p>
<span id="name-old-path-is-preferred"></span><div id="fig-old-path-preferred">
<figure id="figure-6">
            <div id="section-5.2.1-12.1">
              <div class="alignCenter art-svg artwork" id="section-5.2.1-12.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="384" width="352" viewBox="0 0 352 384" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
                  <path d="M 64,80 L 64,176" fill="none" stroke="black"></path>
                  <path d="M 64,224 L 64,320" fill="none" stroke="black"></path>
                  <path d="M 112,48 L 112,112" fill="none" stroke="black"></path>
                  <path d="M 112,288 L 112,352" fill="none" stroke="black"></path>
                  <path d="M 200,48 L 200,112" fill="none" stroke="black"></path>
                  <path d="M 200,288 L 200,352" fill="none" stroke="black"></path>
                  <path d="M 232,96 L 232,240" fill="none" stroke="black"></path>
                  <path d="M 232,272 L 232,304" fill="none" stroke="black"></path>
                  <path d="M 248,80 L 248,176" fill="none" stroke="black"></path>
                  <path d="M 248,208 L 248,320" fill="none" stroke="black"></path>
                  <path d="M 264,64 L 264,112" fill="none" stroke="black"></path>
                  <path d="M 264,144 L 264,336" fill="none" stroke="black"></path>
                  <path d="M 112,48 L 200,48" fill="none" stroke="black"></path>
                  <path d="M 200,64 L 264,64" fill="none" stroke="black"></path>
                  <path d="M 64,80 L 112,80" fill="none" stroke="black"></path>
                  <path d="M 200,80 L 248,80" fill="none" stroke="black"></path>
                  <path d="M 208,96 L 232,96" fill="none" stroke="black"></path>
                  <path d="M 112,112 L 200,112" fill="none" stroke="black"></path>
                  <path d="M 32,176 L 120,176" fill="none" stroke="black"></path>
                  <path d="M 208,176 L 224,176" fill="none" stroke="black"></path>
                  <path d="M 240,176 L 256,176" fill="none" stroke="black"></path>
                  <path d="M 272,176 L 312,176" fill="none" stroke="black"></path>
                  <path d="M 192,208 L 224,208" fill="none" stroke="black"></path>
                  <path d="M 240,208 L 256,208" fill="none" stroke="black"></path>
                  <path d="M 272,208 L 296,208" fill="none" stroke="black"></path>
                  <path d="M 8,224 L 96,224" fill="none" stroke="black"></path>
                  <path d="M 112,288 L 200,288" fill="none" stroke="black"></path>
                  <path d="M 200,304 L 232,304" fill="none" stroke="black"></path>
                  <path d="M 64,320 L 112,320" fill="none" stroke="black"></path>
                  <path d="M 200,320 L 248,320" fill="none" stroke="black"></path>
                  <path d="M 208,336 L 264,336" fill="none" stroke="black"></path>
                  <path d="M 112,352 L 200,352" fill="none" stroke="black"></path>
                  <path d="M 8,224 L 32,176" fill="none" stroke="black"></path>
                  <path d="M 96,224 L 120,176" fill="none" stroke="black"></path>
                  <path d="M 192,208 L 208,176" fill="none" stroke="black"></path>
                  <path d="M 296,208 L 312,176" fill="none" stroke="black"></path>
                  <polygon class="arrowhead" points="216,336 204,330.4 204,341.6" fill="black" transform="rotate(180,208,336)"></polygon>
                  <polygon class="arrowhead" points="216,96 204,90.4 204,101.6" fill="black" transform="rotate(180,208,96)"></polygon>
                  <g class="text">
                    <text x="72" y="36">new</text>
                    <text x="256" y="36">old</text>
                    <text x="76" y="52">path</text>
                    <text x="252" y="52">path</text>
                    <text x="156" y="84">Receiver</text>
                    <text x="264" y="132">1</text>
                    <text x="296" y="132">path-</text>
                    <text x="312" y="148">challenge</text>
                    <text x="68" y="196">off-path</text>
                    <text x="220" y="196">AP</text>
                    <text x="248" y="196">/</text>
                    <text x="280" y="196">NAT</text>
                    <text x="60" y="212">attacker</text>
                    <text x="176" y="260">path-</text>
                    <text x="232" y="260">2</text>
                    <text x="188" y="276">response</text>
                    <text x="156" y="324">Sender</text>
                  </g>
                </svg><a href="#section-5.2.1-12.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-old-path-is-preferred" class="selfRef">Old path is preferred</a>
            </figcaption></figure>
</div>
<p id="section-5.2.1-13">Note that this defense is imperfect, but this is not considered a serious
problem. If the path via the attacker is reliably faster than the
old path despite multiple attempts to use that old path, it
is not possible to distinguish between an attack and an improvement
in routing.<a href="#section-5.2.1-13" class="pilcrow">¶</a></p>
<p id="section-5.2.1-14">An endpoint could also use heuristics to improve detection of this
style of attack. For instance, NAT rebinding is improbable if
packets were recently received on the old path; similarly, rebinding
is rare on IPv6 paths. Endpoints can also look for duplicated
packets. Conversely, a change in connection ID is more likely to
indicate an intentional migration rather than an attack. Note that
changes in connection IDs are supported in DTLS 1.3 but not in
DTLS 1.2.<a href="#section-5.2.1-14" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="path-validation">
<section id="section-6">
      <h2 id="name-path-validation-procedure">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-path-validation-procedure" class="section-name selfRef">Path Validation Procedure</a>
      </h2>
<p id="section-6-1">The receiver that observes the peer's address or port change <span class="bcp14">MUST</span> stop sending
any buffered application data, or limit the data sent to the unvalidated
address to the anti-amplification limit.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">It then initiates the return routability check that proceeds as described
either in <a href="#enhanced" class="auto internal xref">Section 6.2</a> or <a href="#regular" class="auto internal xref">Section 6.1</a>, depending on whether the off-path
attacker scenario described in <a href="#off-path" class="auto internal xref">Section 5.2</a> is to be taken into account.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">(The decision on what strategy to choose depends mainly on the threat model, but
may also be influenced by other considerations.  Examples of impacting factors
include: the need to minimise implementation complexity, privacy concerns, and the
need to reduce the time it takes to switch path.  The choice may be offered as
a configuration option to the user of the TLS implementation.)<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">After the path validation procedure is completed, any pending send operation is
resumed to the bound peer address.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5"><a href="#path-challenge-reqs" class="auto internal xref">Section 6.3</a> and <a href="#path-response-reqs" class="auto internal xref">Section 6.4</a> list the requirements for
the initiator and responder roles, broken down per protocol phase.<a href="#section-6-5" class="pilcrow">¶</a></p>
<div id="regular">
<section id="section-6.1">
        <h3 id="name-basic">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-basic" class="section-name selfRef">Basic</a>
        </h3>
<p id="section-6.1-1">The basic return routability check comprises the following steps:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.1-2">
<li id="section-6.1-2.1">
            <p id="section-6.1-2.1.1">The receiver (i.e., the initiator) creates a <code>return_routability_check</code> message of
type <code>path_challenge</code> and places the unpredictable cookie into the message.<a href="#section-6.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.1-2.2">
            <p id="section-6.1-2.2.1">The message is sent to the observed new address and a timer T (see
<a href="#timer-choice" class="auto internal xref">Section 6.5</a>) is started.<a href="#section-6.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.1-2.3">
            <p id="section-6.1-2.3.1">The peer (i.e., the responder) cryptographically verifies the received
<code>return_routability_check</code> message of
type <code>path_challenge</code> and responds by echoing the cookie value in a
<code>return_routability_check</code> message of type <code>path_response</code>.<a href="#section-6.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.1-2.4">
            <p id="section-6.1-2.4.1">When the initiator receives the <code>return_routability_check</code>
message  of type <code>path_response</code> and verifies that it contains the sent cookie, it updates the peer
address binding.<a href="#section-6.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.1-2.5">
            <p id="section-6.1-2.5.1">If T expires the peer address binding is not updated.<a href="#section-6.1-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="enhanced">
<section id="section-6.2">
        <h3 id="name-enhanced">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-enhanced" class="section-name selfRef">Enhanced</a>
        </h3>
<p id="section-6.2-1">The enhanced return routability check comprises the following steps:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-2">
<li id="section-6.2-2.1">
            <p id="section-6.2-2.1.1">The receiver (i.e., the initiator) creates a <code>return_routability_check</code> message of
type <code>path_challenge</code> and places the unpredictable cookie into the message.<a href="#section-6.2-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-2.2">
            <p id="section-6.2-2.2.1">The message is sent to the previously valid address, which corresponds to the
old path. Additionally, a timer T is started, see <a href="#timer-choice" class="auto internal xref">Section 6.5</a>.<a href="#section-6.2-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li id="section-6.2-2.3">
            <p id="section-6.2-2.3.1">If the path is still functional, the peer (i.e., the responder) cryptographically verifies the received
<code>return_routability_check</code> message of
type <code>path_challenge</code>.
The action to be taken depends on whether the path through which
the message was received is the preferred one or not anymore:<a href="#section-6.2-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.3.2.1">
                <p id="section-6.2-2.3.2.1.1">If the path through which the message was received is preferred,
a <code>return_routability_check</code> message of type <code>path_response</code> <span class="bcp14">MUST</span> be returned.<a href="#section-6.2-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.2-2.3.2.2">
                <p id="section-6.2-2.3.2.2.1">If the path through which the message was received is not preferred,
a <code>return_routability_check</code> message of type <code>path_drop</code> <span class="bcp14">MUST</span> be returned.
In either case, the peer echoes the cookie value in the response.<a href="#section-6.2-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-6.2-2.4">
            <p id="section-6.2-2.4.1">The initiator receives and verifies that the <code>return_routability_check</code>
message contains the previously sent cookie. The actions taken by the
initiator differ based on the received message:<a href="#section-6.2-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.4.2.1">
                <p id="section-6.2-2.4.2.1.1">When a <code>return_routability_check</code> message of type <code>path_response</code> was received,
the initiator <span class="bcp14">MUST</span> continue using the previously valid address, i.e., no switch
to the new path takes place and the peer address binding is not updated.<a href="#section-6.2-2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.2-2.4.2.2">
                <p id="section-6.2-2.4.2.2.1">When a <code>return_routability_check</code> message of type <code>path_drop</code> was received,
the initiator <span class="bcp14">MUST</span> perform a return routability check on the observed new
address, as described in <a href="#regular" class="auto internal xref">Section 6.1</a>.<a href="#section-6.2-2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li id="section-6.2-2.5">
            <p id="section-6.2-2.5.1">If T expires the peer address binding is not updated. In this case, the
initiator <span class="bcp14">MUST</span> perform a return routability check on the observed new
address, as described in <a href="#regular" class="auto internal xref">Section 6.1</a>.<a href="#section-6.2-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ol>
</section>
</div>
<div id="path-challenge-reqs">
<section id="section-6.3">
        <h3 id="name-path-challenge-requirements">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-path-challenge-requirements" class="section-name selfRef">Path Challenge Requirements</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-6.3-1.1">
            <p id="section-6.3-1.1.1">The initiator <span class="bcp14">MAY</span> send multiple <code>return_routability_check</code> messages of type
<code>path_challenge</code> to cater for packet loss on the probed path.<a href="#section-6.3-1.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-1.1.2.1">
                <p id="section-6.3-1.1.2.1.1">Each <code>path_challenge</code> <span class="bcp14">SHOULD</span> go into different transport packets.  (Note that
the DTLS implementation may not have control over the packetization done by
the transport layer.)<a href="#section-6.3-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.3-1.1.2.2">
                <p id="section-6.3-1.1.2.2.1">The transmission of subsequent <code>path_challenge</code> messages <span class="bcp14">SHOULD</span> be paced to
decrease the chance of loss.<a href="#section-6.3-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-6.3-1.1.2.3">
                <p id="section-6.3-1.1.2.3.1">Each <code>path_challenge</code> message <span class="bcp14">MUST</span> contain random data.<a href="#section-6.3-1.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-6.3-1.2">
            <p id="section-6.3-1.2.1">The initiator <span class="bcp14">MAY</span> use padding using the record padding mechanism available in
DTLS 1.3 (and in DTLS 1.2, when CID is enabled on the sending direction) up
to the anti-amplification limit to probe if the path MTU (PMTU) for the new
path is still acceptable.<a href="#section-6.3-1.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="path-response-reqs">
<section id="section-6.4">
        <h3 id="name-path-response-drop-requirem">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-path-response-drop-requirem" class="section-name selfRef">Path Response/Drop Requirements</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-6.4-1.1">
            <p id="section-6.4-1.1.1">The responder <span class="bcp14">MUST NOT</span> delay sending an elicited <code>path_response</code> or
<code>path_drop</code> messages.<a href="#section-6.4-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-1.2">
            <p id="section-6.4-1.2.1">The responder <span class="bcp14">MUST</span> send exactly one <code>path_response</code> or <code>path_drop</code> message
for each received <code>path_challenge</code>.<a href="#section-6.4-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-1.3">
            <p id="section-6.4-1.3.1">The responder <span class="bcp14">MUST</span> send the <code>path_response</code> or the <code>path_drop</code> on the path
where the corresponding <code>path_challenge</code> has been received, so that validation
succeeds only if the path is functional in both directions. The initiator
<span class="bcp14">MUST NOT</span> enforce this behaviour.<a href="#section-6.4-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.4-1.4">
            <p id="section-6.4-1.4.1">The initiator <span class="bcp14">MUST</span> silently discard any invalid <code>path_response</code> or
<code>path_drop</code> it receives.<a href="#section-6.4-1.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.4-2">Note that RRC does not cater for PMTU discovery on the reverse path.  If the
responder wants to do PMTU discovery using RRC, it should initiate a new path
validation procedure.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="timer-choice">
<section id="section-6.5">
        <h3 id="name-timer-choice">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-timer-choice" class="section-name selfRef">Timer Choice</a>
        </h3>
<p id="section-6.5-1">When setting T, implementations are cautioned that the new path could have a
longer round-trip time (RTT) than the original.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">In settings where there is external information about the RTT of the active
path, implementations <span class="bcp14">SHOULD</span> use T = 3xRTT.<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<p id="section-6.5-3">If an implementation has no way to obtain information regarding the RTT of the
active path, T <span class="bcp14">SHOULD</span> be set to 1s.<a href="#section-6.5-3" class="pilcrow">¶</a></p>
<p id="section-6.5-4">Profiles for specific deployment environments -- for example, constrained
networks <span>[<a href="#I-D.ietf-uta-tls13-iot-profile" class="cite xref">I-D.ietf-uta-tls13-iot-profile</a>]</span> -- <span class="bcp14">MAY</span> specify a different, more
suitable value for T.<a href="#section-6.5-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="example">
<section id="section-7">
      <h2 id="name-example">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-example" class="section-name selfRef">Example</a>
      </h2>
<p id="section-7-1">In the example DTLS 1.3 handshake shown in <a href="#fig-handshake" class="auto internal xref">Figure 7</a>, a client
and a server successfully negotiate support for both CID and the RRC
extension.<a href="#section-7-1" class="pilcrow">¶</a></p>
<span id="name-message-flow-for-full-dtls-"></span><div id="fig-handshake">
<figure id="figure-7">
        <div class="alignLeft art-text artwork" id="section-7-2.1">
<pre>
       Client                                           Server

Key  ^ ClientHello
Exch | + key_share
     | + signature_algorithms
     | + rrc
     v + connection_id=empty
                               --------&gt;
                                                  ServerHello  ^ Key
                                                 +  key_share  | Exch
                                          + connection_id=100  |
                                                        + rrc  v
                                        {EncryptedExtensions}  ^  Server
                                         {CertificateRequest}  v  Params
                                                {Certificate}  ^
                                          {CertificateVerify}  | Auth
                               &lt;--------           {Finished}  v

     ^ {Certificate}
Auth | {CertificateVerify}
     v {Finished}              --------&gt;
       [Application Data]      &lt;-------&gt;  [Application Data]

              +  Indicates noteworthy extensions sent in the
                 previously noted message.

              *  Indicates optional or situation-dependent
                 messages/extensions that are not always sent.

              {} Indicates messages protected using keys
                 derived from a [sender]_handshake_traffic_secret.

              [] Indicates messages protected using keys
                 derived from [sender]_application_traffic_secret_N.
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-message-flow-for-full-dtls-" class="selfRef">Message Flow for Full DTLS Handshake</a>
        </figcaption></figure>
</div>
<p id="section-7-3">Once a connection has been established, the client and the server
exchange application payloads protected by DTLS with a unilaterally used
CID. In our case, the client is requested to use CID 100 for records
sent to the server.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">At some point in the communication interaction, the IP address used by
the client changes and, thanks to the CID usage, the security context to
interpret the record is successfully located by the server.  However, the
server wants to test the reachability of the client at its new IP address.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5"><a href="#fig-rrc-example" class="auto internal xref">Figure 8</a> shows the server initiating a "basic" RRC exchange
(see <a href="#regular" class="auto internal xref">Section 6.1</a>) that establishes reachability of the client at the new
IP address.<a href="#section-7-5" class="pilcrow">¶</a></p>
<span id="name-basic-return-routability-ex"></span><div id="fig-rrc-example">
<figure id="figure-8">
        <div class="alignLeft art-text artwork" id="section-7-6.1">
<pre>
      Client                                             Server
      ------                                             ------

      Application Data            ========&gt;
      &lt;CID=100&gt;
      Src-IP=A
      Dst-IP=Z
                                  &lt;========        Application Data
                                                       Src-IP=Z
                                                       Dst-IP=A


                              &lt;&lt;-------------&gt;&gt;
                              &lt;&lt;   Some      &gt;&gt;
                              &lt;&lt;   Time      &gt;&gt;
                              &lt;&lt;   Later     &gt;&gt;
                              &lt;&lt;-------------&gt;&gt;


      Application Data            ========&gt;
      &lt;CID=100&gt;
      Src-IP=B
      Dst-IP=Z

                                             &lt;&lt;&lt; Unverified IP
                                                 Address B &gt;&gt;

                                  &lt;--------  Return Routability Check
                                             path_challenge(cookie)
                                                    Src-IP=Z
                                                    Dst-IP=B

      Return Routability Check    --------&gt;
      path_response(cookie)
      Src-IP=B
      Dst-IP=Z

                                             &lt;&lt;&lt; IP Address B
                                                 Verified &gt;&gt;


                                  &lt;========        Application Data
                                                       Src-IP=Z
                                                       Dst-IP=B
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-basic-return-routability-ex" class="selfRef">"Basic" Return Routability Example</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">Note that the return routability checks do not protect against flooding of
third-parties if the attacker is on-path, as the attacker can redirect the
return routability checks to the real peer (even if those datagrams are
cryptographically authenticated).  On-path adversaries can, in general, pose a
harm to connectivity.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="privacy-considerations">
<section id="section-9">
      <h2 id="name-privacy-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-9-1">When using DTLS 1.3, peers <span class="bcp14">SHOULD</span> avoid using the same CID on multiple network
paths, in particular when initiating connection migration or when probing a new
network path, as described in <a href="#path-validation" class="auto internal xref">Section 6</a>, as an adversary can otherwise
correlate the communication interaction across those different paths.  DTLS 1.3
provides mechanisms to ensure that a new CID can always be used.  In
general, an endpoint should proactively send a RequestConnectionId message to ask for new
CIDs as soon as the pool of spare CIDs is depleted (or goes below a threshold).
Also, in case a peer might have exhausted available CIDs, a migrating endpoint
could include NewConnectionId in packets sent on the new path to make sure that
the subsequent path validation can use fresh CIDs.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">Note that DTLS 1.2 does not offer the ability to request new CIDs during the session lifetime since CIDs have the same life-span
of the connection.  Therefore, deployments that use DTLS in multihoming
environments <span class="bcp14">SHOULD</span> refuse to use CIDs with DTLS 1.2
and switch to DTLS 1.3 if the correlation privacy threat is a concern.<a href="#section-9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="operational-considerations">
<section id="section-10">
      <h2 id="name-operational-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-operational-considerations" class="section-name selfRef">Operational Considerations</a>
      </h2>
<div id="logging-anomalous-events">
<section id="section-10.1">
        <h3 id="name-logging-anomalous-events">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-logging-anomalous-events" class="section-name selfRef">Logging Anomalous Events</a>
        </h3>
<p id="section-10.1-1">Logging of RRC operations at both ends of the protocol can be generally useful for the users of an implementation.
In particular, for security information and event management (SIEM) and troubleshooting purposes, it is strongly advised that implementations collect statistics about any unsuccessful RRC operations, as they could represent security-relevant events when they coincide with attempts by an attacker to interfere with the end-to-end path.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="middlebox-interference">
<section id="section-10.2">
        <h3 id="name-middlebox-interference">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-middlebox-interference" class="section-name selfRef">Middlebox Interference</a>
        </h3>
<p id="section-10.2-1">Since the DTLS 1.3 encrypted packet's record type is opaque to on-path observers, RRC messages are immune to middlebox interference when using DTLS 1.3.
In contrast, DTLS 1.2 RRC messages that are not wrapped in the <code>tls12_cid</code> record (e.g., in the server-to-client direction if the server didn't negotiate a CID or it negotiated a zero-length CID) have the <code>return_routability_check</code> content type in plain text, making them susceptible to interference (e.g., dropping of <code>path_challenge</code> messages), which would hinder the RRC functionality altogether.
Therefore, when using RRC in DTLS 1.2, it is recommended to enable CID in both directions.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-11-1"><span class="cref" id="to-be-removed">RFC Editor: please replace RFCthis with this RFC number and remove this note.</span><a href="#section-11-1" class="pilcrow">¶</a></p>
<div id="new-tls-contenttype">
<section id="section-11.1">
        <h3 id="name-new-tls-contenttype">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-new-tls-contenttype" class="section-name selfRef">New TLS ContentType</a>
        </h3>
<p id="section-11.1-1">IANA is requested to allocate an entry to the TLS <code>ContentType</code>
registry, for the <code>return_routability_check(TBD2)</code> message defined in
this document.  IANA is requested to set the <code>DTLS_OK</code> column to <code>Y</code> and
to add the following note prior to the table:<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-11.1-2.1">
            <p id="section-11.1-2.1.1">NOTE: The return_routability_check content type is only
applicable to DTLS 1.2 and 1.3.<a href="#section-11.1-2.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="new-tls-extensiontype">
<section id="section-11.2">
        <h3 id="name-new-tls-extensiontype">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-new-tls-extensiontype" class="section-name selfRef">New TLS ExtensionType</a>
        </h3>
<p id="section-11.2-1">IANA is requested to allocate the extension code point (TBD1) for the <code>rrc</code>
extension to the <code>TLS ExtensionType Values</code> registry as described in
<a href="#tbl-ext" class="auto internal xref">Table 1</a>.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<span id="name-rrc-entry-in-the-tls-extens"></span><div id="tbl-ext">
<table class="left" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-rrc-entry-in-the-tls-extens" class="selfRef">rrc entry in the TLS ExtensionType Values registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Extension Name</th>
              <th class="text-left" rowspan="1" colspan="1">TLS 1.3</th>
              <th class="text-left" rowspan="1" colspan="1">DTLS-Only</th>
              <th class="text-left" rowspan="1" colspan="1">Recommended</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Comment</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD1</td>
              <td class="text-left" rowspan="1" colspan="1">rrc</td>
              <td class="text-left" rowspan="1" colspan="1">CH, SH</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="new-rrc-message-type-sub-registry">
<section id="section-11.3">
        <h3 id="name-new-rrc-message-type-sub-re">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-new-rrc-message-type-sub-re" class="section-name selfRef">New RRC Message Type Sub-registry</a>
        </h3>
<p id="section-11.3-1">IANA is requested to create a new registry for RRC Message Types within the TLS Parameters registry group <span>[<a href="#IANA.tls-parameters" class="cite xref">IANA.tls-parameters</a>]</span>.
This registry will be administered under the "Expert Review" policy (<span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.5" class="relref">Section 4.5</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>).<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<p id="section-11.3-2">Follow the procedures in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-rfc8447bis-13#section-16" class="relref">Section 16</a> of [<a href="#I-D.ietf-tls-rfc8447bis" class="cite xref">I-D.ietf-tls-rfc8447bis</a>]</span> to submit registration requests.<a href="#section-11.3-2" class="pilcrow">¶</a></p>
<p id="section-11.3-3">Each entry in the registry must include the following fields:<a href="#section-11.3-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-11.3-4">
          <dt id="section-11.3-4.1">Value:</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-4.2">
            <p id="section-11.3-4.2.1">A (decimal) number in the range 0 to 253<a href="#section-11.3-4.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-4.3">Description:</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-4.4">
            <p id="section-11.3-4.4.1">A brief description of the RRC message<a href="#section-11.3-4.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-4.5">DTLS-Only:</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-4.6">
            <p id="section-11.3-4.6.1">Whether the message applies only to DTLS.
Since RRC is only available in DTLS, this column will be set to <code>Y</code> for all the entries in this registry<a href="#section-11.3-4.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-4.7">Recommended:</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-4.8">
            <p id="section-11.3-4.8.1">Whether the message is recommended for implementations to support.
The semantics for this field is defined in <span><a href="https://rfc-editor.org/rfc/rfc8447#section-5" class="relref">Section 5</a> of [<a href="#RFC8447" class="cite xref">RFC8447</a>]</span> and updated in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-rfc8447bis-13#section-3" class="relref">Section 3</a> of [<a href="#I-D.ietf-tls-rfc8447bis" class="cite xref">I-D.ietf-tls-rfc8447bis</a>]</span><a href="#section-11.3-4.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-4.9">Reference:</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-4.10">
            <p id="section-11.3-4.10.1">A reference to a publicly available specification for the value<a href="#section-11.3-4.10.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-4.11">Comment:</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-4.12">
            <p id="section-11.3-4.12.1">Any relevant notes or comments that relate to this entry<a href="#section-11.3-4.12.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-11.3-5">The initial state of this sub-registry is as follows:<a href="#section-11.3-5" class="pilcrow">¶</a></p>
<span id="name-initial-entries-in-rrc-mess"></span><div id="tbl-rrc-mt">
<table class="left" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-initial-entries-in-rrc-mess" class="selfRef">Initial Entries in RRC Message Type registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">DTLS-Only</th>
              <th class="text-left" rowspan="1" colspan="1">Recommended</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
              <th class="text-left" rowspan="1" colspan="1">Comment</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">path_challenge</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">path_response</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">path_drop</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3-253</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">254-255</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved for Private Use</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">RFCthis</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-11.3-7">IANA is requested to add the following note for additional information regarding the use of RRC message codepoints in experiments:<a href="#section-11.3-7" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.3-8">
          <dt id="section-11.3-8.1">Note:</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-8.2">
            <p id="section-11.3-8.2.1">As specified in <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>, assignments made in the Private Use space are not generally useful for broad interoperability.
Those making use of the Private Use range are responsible for ensuring that no conflicts occur within the intended scope of use.
For widespread experiments, provisional registrations (<span><a href="https://rfc-editor.org/rfc/rfc8126#section-4.13" class="relref">Section 4.13</a> of [<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>) are available.<a href="#section-11.3-8.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<div id="designated-expert-instructions">
<section id="section-11.3.1">
          <h4 id="name-designated-expert-instructi">
<a href="#section-11.3.1" class="section-number selfRef">11.3.1. </a><a href="#name-designated-expert-instructi" class="section-name selfRef">Designated Expert Instructions</a>
          </h4>
<p id="section-11.3.1-1">To enable a broadly informed review of registration decisions, it is recommended that multiple Designated Experts be appointed who are able to represent the perspectives of both the transport and security areas.<a href="#section-11.3.1-1" class="pilcrow">¶</a></p>
<p id="section-11.3.1-2">In cases where a registration decision could be perceived as creating a conflict of interest for a particular Expert, that Expert <span class="bcp14">SHOULD</span> defer to the judgment of the other Experts.<a href="#section-11.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="section-12">
      <h2 id="name-acknowledgments">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-12-1">We would like to thank
Eric Rescorla,
Hanno Becker,
<span class="contact-name">Hanno Böck</span>,
Joe Clarke,
<span class="contact-name">Manuel Pégourié-Gonnard</span>,
Marco Tiloca,
Martin Thomson,
Mohit Sahni,
Rich Salz,
Russ Housley,
Sean Turner, and
Yaron Sheffer
for their input to this document.<a href="#section-12-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-combined-references">
<section id="section-13">
      <h2 id="name-references">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-13.1">
        <h3 id="name-normative-references">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-tls-rfc8447bis">[I-D.ietf-tls-rfc8447bis]</dt>
        <dd>
<span class="refAuthor">Salowey, J. A.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"IANA Registry Updates for TLS and DTLS"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-rfc8447bis-13</span>, <time datetime="2025-05-29" class="refDate">29 May 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-tls-rfc8447bis-13">https://datatracker.ietf.org/doc/html/draft-ietf-tls-rfc8447bis-13</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.tls-parameters">[IANA.tls-parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Transport Layer Security (TLS) Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/tls-parameters">https://www.iana.org/assignments/tls-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8446">https://www.rfc-editor.org/rfc/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8447">[RFC8447]</dt>
        <dd>
<span class="refAuthor">Salowey, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"IANA Registry Updates for TLS and DTLS"</span>, <span class="seriesInfo">RFC 8447</span>, <span class="seriesInfo">DOI 10.17487/RFC8447</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8447">https://www.rfc-editor.org/rfc/rfc8447</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9146">[RFC9146]</dt>
        <dd>
<span class="refAuthor">Rescorla, E., Ed.</span>, <span class="refAuthor">Tschofenig, H., Ed.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">A. Kraus</span>, <span class="refTitle">"Connection Identifier for DTLS 1.2"</span>, <span class="seriesInfo">RFC 9146</span>, <span class="seriesInfo">DOI 10.17487/RFC9146</span>, <time datetime="2022-03" class="refDate">March 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9146">https://www.rfc-editor.org/rfc/rfc9146</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9147">[RFC9147]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 9147</span>, <span class="seriesInfo">DOI 10.17487/RFC9147</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9147">https://www.rfc-editor.org/rfc/rfc9147</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-13.2">
        <h3 id="name-informative-references">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-uta-tls13-iot-profile">[I-D.ietf-uta-tls13-iot-profile]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H.</span>, <span class="refAuthor">Fossati, T.</span>, and <span class="refAuthor">M. Richardson</span>, <span class="refTitle">"TLS/DTLS 1.3 Profiles for the Internet of Things"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-uta-tls13-iot-profile-14</span>, <time datetime="2025-05-05" class="refDate">5 May 2025</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-uta-tls13-iot-profile-14">https://datatracker.ietf.org/doc/html/draft-ietf-uta-tls13-iot-profile-14</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.irtf-t2trg-amplification-attacks">[I-D.irtf-t2trg-amplification-attacks]</dt>
        <dd>
<span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">C. Amsüss</span>, <span class="refTitle">"Amplification Attacks Using the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-irtf-t2trg-amplification-attacks-04</span>, <time datetime="2024-12-08" class="refDate">8 December 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-irtf-t2trg-amplification-attacks-04">https://datatracker.ietf.org/doc/html/draft-irtf-t2trg-amplification-attacks-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9000">[RFC9000]</dt>
        <dd>
<span class="refAuthor">Iyengar, J., Ed.</span> and <span class="refAuthor">M. Thomson, Ed.</span>, <span class="refTitle">"QUIC: A UDP-Based Multiplexed and Secure Transport"</span>, <span class="seriesInfo">RFC 9000</span>, <span class="seriesInfo">DOI 10.17487/RFC9000</span>, <time datetime="2021-05" class="refDate">May 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9000">https://www.rfc-editor.org/rfc/rfc9000</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9175">[RFC9175]</dt>
      <dd>
<span class="refAuthor">Amsüss, C.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">G. Selander</span>, <span class="refTitle">"Constrained Application Protocol (CoAP): Echo, Request-Tag, and Token Processing"</span>, <span class="seriesInfo">RFC 9175</span>, <span class="seriesInfo">DOI 10.17487/RFC9175</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9175">https://www.rfc-editor.org/rfc/rfc9175</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hannes Tschofenig (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">University of Applied Sciences Bonn-Rhein-Sieg</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:Hannes.Tschofenig@gmx.net" class="email">Hannes.Tschofenig@gmx.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Achim Kraus</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:achimkraus@gmx.net" class="email">achimkraus@gmx.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Thomas Fossati</span></div>
<div dir="auto" class="left"><span class="org">Linaro</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:thomas.fossati@linaro.org" class="email">thomas.fossati@linaro.org</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
